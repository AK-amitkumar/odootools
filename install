#!/bin/bash
function odooutv {
    if [ ! -f /etc/odoo/odoopasswords ]; then
        echo LÃ¶senordsfilen hittades inte!
        echo /etc/odoo/odoopasswords
        exit
    fi
    cat bash.odoo > temp
    cat odooutv|sed s/_MYSQL_PASSWORD_/$(sudo cat /etc/odoo/odoopasswords|grep _MYSQL_PASSWORD_|sed s/_MYSQL_PASSWORD_\ //)/ >> temp
    sudo cp -f temp /etc/bash.odoo
    sudo chown root:root /etc/bash.odoo
    rm -rf temp
    cat /etc/bash.bashrc|grep -v .\ /etc/bash.odoo > temp
    echo . /etc/bash.odoo >> temp
    sudo cp -f temp /etc/bash.bashrc
    rm -rf temp
    echo Done
}

function personlig {
    cat bash.odoo > temp
    cat personlig >> temp
    sudo cp -f temp /etc/bash.odoo
    sudo chown $USER:$USER /etc/bash.odoo
    rm -rf temp
    cat /etc/bash.bashrc|grep -v .\ /etc/bash.odoo > temp
    echo . /etc/bash.odoo >> temp
    sudo cp -f temp /etc/bash.bashrc
    rm -rf temp
    echo Done
}

# Install Odoo (if its not installed already)
if [ ! -f /etc/apt/sources.list.d/odoo.list ]; do
    sudo wget -O - https://nightly.odoo.com/odoo.key | apt-key add -
    sudo echo "deb http://nightly.odoo.com/8.0/nightly/deb/ ./" > /etc/apt/sources.list.d/odoo.list
    sudo apt-get update && sudo apt-get install odoo
done

sudo wget -O /etc/bash.odoo https://raw.githubusercontent.com/vertelab/odootools/master/bash.odoo
sudo grep -v bash.odoo /etc/bash.bashrc > /etc/bash.bashrc
sudo echo ". /etc/bash.odoo" >> /etc/bash.bashrc

sudo wget -O /etc/bash_completion.d/odoo https://raw.githubusercontent.com/vertelab/odootools/master/bash_completion.odoo

sudo wget -O /etc/cron.daily/db_backup https://raw.githubusercontent.com/vertelab/odootools/master/db_backup
sudo chmod a+x /etc/cron.daily/db_backup

